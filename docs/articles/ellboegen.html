<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • foehnix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="">
<meta property="og:description" content="foehnix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foehnix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ellboegen.html">[Demo] Ellbögen (Tyrol, A)</a>
    </li>
    <li>
      <a href="../articles/viejas.html">[Demo] Viejas (California, USA)</a>
    </li>
    <li>
      <a href="../articles/windrose.html">[Plot] Wind Rose</a>
    </li>
    <li>
      <a href="../articles/tsplot.html">[Plot] Time Series</a>
    </li>
    <li>
      <a href="../articles/image.html">[Plot] Hovmöller Diagram</a>
    </li>
    <li>
      <a href="../articles/import_data.html">Import Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mixedmodel.html">Statistical Model</a>
    </li>
    <li>
      <a href="../articles/logisticregression.html">Logistic Regression (IWLS)</a>
    </li>
    <li>
      <a href="../articles/inference.html">Inference</a>
    </li>
    <li>
      <a href="../articles/advanced_simulation.html">Censoring and Truncation</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Verification with Simulated Data</a>
    </li>
    <li>
      <a href="../articles/families.html">foehnix Families</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/retostauffer/Rfoehnix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ellboegen_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="ellboegen_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="ellboegen_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="ellboegen_files/leaflet-1.3.1/leaflet.js"></script><link href="ellboegen_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="ellboegen_files/proj4-2.6.2/proj4.min.js"></script><script src="ellboegen_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="ellboegen_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="ellboegen_files/leaflet-binding-2.1.2/leaflet.js"></script><script src="ellboegen_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="ellboegen_files/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/retostauffer/Rfoehnix/blob/HEAD/vignettes/ellboegen.Rmd" class="external-link"><code>vignettes/ellboegen.Rmd</code></a></small>
      <div class="hidden name"><code>ellboegen.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="data-set-description">Data Set Description<a class="anchor" aria-label="anchor" href="#data-set-description"></a>
</h2>
<p>The “Tyrolean” data set provides hourly observations from two stations, namely “Ellbögen” and “Sattelberg” located in Tyrol, Austria.</p>
<p>Ellbögen is our target station (valley site) located in the Wipp Valley, a north-south oriented alpine valley on the northern side of the European Alps. To the north the Wipp Valley opens into the Inn Valley (close to Innsbruck, the capitol of Tyrol), to the south the valley ends at a narrow gap in the main Alpine ridge called Brennerpass (<span class="math inline">\(1370~m\)</span>; the pass between Austria and Italy) flanked by mountains (<span class="math inline">\(&gt;2100~m\)</span>). The Wipp Valley is one of the lowest and most distinct cuts trough the Alpine mountain range and well known for south foehn (north of the Alps). Station Sattelberg serves as crest station and provides observations of the upstream air mass during south foehn events. The station is located on top of the mountain to the west of the pass.</p>
<div id="htmlwidget-fa9a07b8f08576166ba2" style="width:100%;height:480px;" class="leaflet html-widget "></div>
<script type="application/json" data-for="htmlwidget-fa9a07b8f08576166ba2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPopups","args":[47.18694,11.42889,"Station Ellbögen, 1080 m a.m.s.l.",null,null,{"maxWidth":300,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"className":""}]},{"method":"addPopups","args":[47.01083,11.47889,"Station Sattelberg, 2107 m a.m.s.l.",null,null,{"maxWidth":300,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"className":""}]},{"method":"addProviderTiles","args":["OpenTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]}],"setView":[[47.098885,11.45389],10.5,[]],"limits":{"lat":[47.01083,47.18694],"lng":[11.42889,11.47889]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="loading-the-data-set">Loading the Data Set<a class="anchor" aria-label="anchor" href="#loading-the-data-set"></a>
</h2>
<p>The call <a href="references/demodata"><code>demodata("tyrol")</code></a> returns the combined data set for both station (Ellbögen and Sattelberg). In addition, the potential temperature difference between the two stations is calculated by reducing the dry air temperature from “Sattelberg” to the height of “Ellbögen” (dry adiabatic lapse rate of 1K per 100m; stored on <code>diff_t</code>). Details can be found on the <a href="references/demodata.html"><code>demodata</code></a> reference page.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demodata.html">demodata</a></span><span class="op">(</span><span class="st">"tyrol"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      dd  ff  rh    t crest_dd crest_ff crest_rh crest_t diff_t</span></span>
<span><span class="co">## 2006-01-01 01:00:00 171 0.6  90 -0.4      180     10.8      100    -7.8   2.87</span></span>
<span><span class="co">## 2006-01-01 02:00:00 268 0.3 100 -1.8      186     12.5      100    -8.0   4.07</span></span>
<span><span class="co">## 2006-01-01 03:00:00 115 5.2  79  0.9      181     11.3      100    -7.4   1.97</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check if our object is a numeric zoo object:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.zoo"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/zoo.html" class="external-link">is.zoo</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  <span class="st">"is.numeric"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  <span class="st">"is regular"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/is.regular.html" class="external-link">is.regular</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  <span class="st">"is strictly regular"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/is.regular.html" class="external-link">is.regular</a></span><span class="op">(</span><span class="va">data</span>, strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              is.zoo          is.numeric          is regular is strictly regular </span></span>
<span><span class="co">##                TRUE                TRUE                TRUE               FALSE</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tepmoral resolution (seconds)"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">deltat</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  <span class="st">"missing values"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tepmoral resolution (seconds)                missing values </span></span>
<span><span class="co">##                          3600                         87267</span></span></code></pre>
<p>The data set returned is a regular <code>numeric</code> <code>zoo</code> time series object. Note that the data set is not strictly regular (contains hourly observations, but some are missing) and contains quite some missing values (<code>NA</code>). This is not a problem as the functions and methods will take care of missing values and inflate the time series object (regular <span class="math inline">\(\rightarrow\)</span> strictly regular).</p>
<p><strong>Important:</strong> The names of the variables in the Tyrolean data set are the “<em>standard names</em>” on which most functions and methods provided by this package are based on. To be precise:</p>
<ul>
<li>
<strong>Valley station:</strong> air temperature <code>t</code>, relative humidity <code>rh</code>, wind speed <code>ff</code>, wind direction <code>dd</code> (meteorological, degrees <span class="math inline">\(\in [0, 360]\)</span>)</li>
<li>
<strong>Crest station:</strong> air temperature <code>crest_t</code>, relative humidity <code>crest_rh</code>, wind speed <code>crest_ff</code>, wind direction <code>crest_dd</code> (<span class="math inline">\(\in [0, 360]\)</span>)</li>
<li>
<strong>In addition:</strong> Potential temperature difference <code>diff_t</code> (calculated by <a href="references/demodata.html"><code>demodata</code></a>
</li>
</ul>
<p>… however, all functions arguments which allow to set custom names (see “<a href="articles/viejas.html">Demos &gt; Viejas (California, USA)</a>” or function references).</p>
<p>After preparing the data set (regular or strictly regular <code>zoo   object with</code>numeric` values) we can investigate the observed wind information.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Observed wind speed/wind direction "Ellboegen"</span></span>
<span><span class="co"># Expects a variable 'dd' and 'ff' by default. Thus,</span></span>
<span><span class="co"># 'ddvar'/'ffvar' do not have to be specified.</span></span>
<span><span class="fu"><a href="../reference/windrose.html">windrose</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Windrose Ellbögen"</span>,</span>
<span>         breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Observed wind speed/wind direction "Sattelberg"</span></span>
<span><span class="co"># Specify dd/ff of the crest station (ddvar, ffvar)</span></span>
<span><span class="fu"><a href="../reference/windrose.html">windrose</a></span><span class="op">(</span><span class="va">data</span>, ddvar <span class="op">=</span> <span class="st">"crest_dd"</span>, ffvar <span class="op">=</span> <span class="st">"crest_ff"</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Windrose Sattelberg"</span>, hue <span class="op">=</span> <span class="fl">270</span>,</span>
<span>         breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/emp_windrose-1.png" width="1152"></p>
<p>Based on prior knowledge and the plots above we define two “foehn wind sectors” as follows:</p>
<ul>
<li>At <strong>Ellbögen</strong> the observed wind direction (<code>dd</code>) needs to be along valley within 43 and 223 degrees (south-easterly; a 180 degree sector).</li>
<li>At <strong>Sattelberg</strong> the observed wind direction (<code>crest_dd</code>) needs to be within 90 and 270 degrees (south wind; 180 degree sector).</li>
</ul>
<p>The wind sector(s) can be added to the <a href="references/windrose.html"><code>windrose</code></a> plots for visual justification, but well also be used later when estimating the <a href="references/foehnix.html"><code>foehnix</code></a> classification model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Ellboegen with custom wind sector</span></span>
<span><span class="fu"><a href="../reference/windrose.html">windrose</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>         windsector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"south-east wind"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Windrose Ellbögen"</span>,</span>
<span>         breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Observed wind speed/wind direction "Sattelberg"</span></span>
<span><span class="co"># Specify custom variable names for dd/ff (crest_dd, crest_ff).</span></span>
<span><span class="fu"><a href="../reference/windrose.html">windrose</a></span><span class="op">(</span><span class="va">data</span>, ddvar <span class="op">=</span> <span class="st">"crest_dd"</span>, ffvar <span class="op">=</span> <span class="st">"crest_ff"</span>,</span>
<span>         windsector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"south wind"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">270</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Windrose Sattelberg"</span>, hue <span class="op">=</span> <span class="fl">270</span>,</span>
<span>         breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/windsector_windrose-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="estimate-classification-model">Estimate Classification Model<a class="anchor" aria-label="anchor" href="#estimate-classification-model"></a>
</h2>
<p>The most important step is to estimate the <a href="references/foehnix.html"><code>foehnix</code></a> classification model. We use the following model assumptions:</p>
<ul>
<li>
<strong>Main variable</strong>: <code>diff_t</code> is used as the main covariate to separate ‘foehn’ from ‘no foehn’ events (potential temperature difference).</li>
<li>
<strong>Concomitant variable</strong>: <code>rh</code> and <code>ff</code> at valley site (relative humidity and wind speed).</li>
<li>
<strong>Wind filters</strong>: two filters are defined. <code>dd = c(43, 223)</code> for Ellbögen and <code>crest_dd = c(90, 270)</code> for Sattelberg (see above).</li>
<li>
<strong>Option switch:</strong> <code>switch = TRUE</code> as high <code>diff_temp</code> indicate stable stratification (no foehn).</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the foehnix classification model</span></span>
<span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span>, crest_dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">270</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">diff_t</span> <span class="op">~</span> <span class="va">rh</span> <span class="op">+</span> <span class="va">ff</span>,</span>
<span>               data   <span class="op">=</span> <span class="va">data</span>,</span>
<span>               switch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               filter <span class="op">=</span> <span class="va">filter</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="model-summary">Model Summary<a class="anchor" aria-label="anchor" href="#model-summary"></a>
</h4>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call: foehnix(formula = diff_t ~ rh + ff, data = data, switch = TRUE, </span></span>
<span><span class="co">##     filter = filter)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of observations (total)   113952 (5527 due to inflation)</span></span>
<span><span class="co">## Removed due to missing values     38859 (34.1 percent)</span></span>
<span><span class="co">## Outside defined wind sector       50665 (44.5 percent)</span></span>
<span><span class="co">## Used for classification           24428 (21.4 percent)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Climatological foehn occurance 18.36 percent (on n = 75093)</span></span>
<span><span class="co">## Mean foehn probability 18.06 percent (on n = 75093)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log-likelihood: -55044.0, 7 effective degrees of freedom</span></span>
<span><span class="co">## Corresponding AIC = 110101.9, BIC = 110158.6</span></span>
<span><span class="co">## Time required for model estimation: 2.2 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cluster separation (ratios close to 1 indicate</span></span>
<span><span class="co">## well separated clusters):</span></span>
<span><span class="co">##                        prior  size post&gt;0 ratio</span></span>
<span><span class="co">## Component 1 (foehn)     0.56 13785  19437  0.71</span></span>
<span><span class="co">## Component 2 (no foehn)  0.44 10643  22764  0.47</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ---------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Concomitant model: z test of coefficients</span></span>
<span><span class="co">##                 Estimate Std. error   z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">## cc.(Intercept)  0.812721   0.105710    7.6882 1.492e-14 ***</span></span>
<span><span class="co">## cc.rh          -1.029320   0.001446 -711.8479 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## cc.ff           3.305436   0.012134  272.4222 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## Number of IWLS iterations: 2 (algorithm converged)</span></span>
<span><span class="co">## Dispersion parameter for binomial family taken to be 1.</span></span></code></pre>
<p>The data set contains <span class="math inline">\(N = 113952\)</span> observations, <span class="math inline">\(108425\)</span> from the data set itself (<code>data</code>) and <span class="math inline">\(5527\)</span> due to inflation used to make the time series object strictly regular.</p>
<p>Due to missing data <span class="math inline">\(38859\)</span> observations are not considered during model estimation (<code>dd</code>, <code>crest_dd</code>, <code>diff_t</code>, <code>rh</code>, or <code>ff</code> missing), <span class="math inline">\(50665\)</span> and are not included in model estimation as they do not lie within the defined wind sectors (<code>filter</code>). Thus, the <a href="references/foehnix.html"><code>foehnix</code></a> model is based on a total number of <span class="math inline">\(24428\)</span> observations (or rows).</p>
<p>Once we have estimated the model we can check whether or not the two clusters are well separated (foehn and no foehn). This can be done by checking the “<em>Cluster separation</em>” summary provided by <a href="references/summary.html"><code>summary</code></a> or checking the posterior probability plot:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cluster separation (summary)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">$</span><span class="va">separation</span></span></code></pre></div>
<pre><code><span><span class="co">##                            prior  size post&gt;0     ratio</span></span>
<span><span class="co">## Component 1 (foehn)    0.5596183 13785  19437 0.7092144</span></span>
<span><span class="co">## Component 2 (no foehn) 0.4403817 10643  22764 0.4675365</span></span></code></pre>
<p>The <code>separation</code> matrix shows the prior probabilities, the size (number of observations assigned to each component; posterior probability), number of probabilities exceeding a threshold (default <code>eps = 1e-4</code>), and the ratio between the latter two. Ratios close to <span class="math inline">\(1.0\)</span> indicate that the two clusters are well separated (<span class="math inline">\(ratio &gt; 0.5\)</span> are already good for this application).</p>
<p>The “posterior probability histogram” (<code>plot(..., which = "posterior")</code>) shows the empirical histogram of estimated probabilities (for within-windsector observations). Point masses around <span class="math inline">\(0.0\)</span> and <span class="math inline">\(1.0\)</span> indicate that we have two well separated clusters (the probability to fall in one of the clusters is always close to either <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="st">"posterior"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ellboegen_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="estimated-coefficients">Estimated Coefficients<a class="anchor" aria-label="anchor" href="#estimated-coefficients"></a>
</h2>
<p>The following parameters are estimated for the two Gaussian clusters:</p>
<ul>
<li>No-foehn cluster: <span class="math inline">\(\mu_1 = 5.8\)</span>, <span class="math inline">\(\sigma_1 = 2.64\)</span> (parameter scale)</li>
<li>Foehn cluster: <span class="math inline">\(\mu_2 = 0.86\)</span>, <span class="math inline">\(\sigma_2 = 1.33\)</span> (parameter scale)</li>
<li>Concomitant model: positive <code>rh</code> effect of -5.3 percent per on relative humidity and a positive <code>ff</code> effect of +141.4 percent on wind speed</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coefficients of foehnix model</span></span>
<span><span class="co">## Model formula:           diff_t ~ rh + ff</span></span>
<span><span class="co">## foehnix family of class: Gaussian</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients</span></span>
<span><span class="co">##         mu1      sigma1         mu2      sigma2 (Intercept)          rh </span></span>
<span><span class="co">##  5.79908130  2.64068519  0.85860362  1.32845891 -1.19979850 -0.05476087 </span></span>
<span><span class="co">##          ff </span></span>
<span><span class="co">##  0.88116142</span></span></code></pre>
<p>In other words: if the relative humidity increases the probability that we observed foehn decreases, while the probability increases with increasing wind speed.</p>
</div>
<div class="section level2">
<h2 id="graphical-model-assessment">Graphical Model Assessment<a class="anchor" aria-label="anchor" href="#graphical-model-assessment"></a>
</h2>
<p>A <a href="references/foehnix.html"><code>foehnix</code></a> object comes with generic plots for graphical model assessment.</p>
<p>The following figure shows the ‘log-likelihood contribution’ of</p>
<ul>
<li>the main <strong>component</strong> (left hand side of formula),</li>
<li>the <strong>concomitant</strong> model (right hand side of formula),</li>
<li>and the <strong>full</strong> log-likelihood sum which is maximised by the optimization algorithm.</li>
</ul>
<p>The abscissa shows (by default) the logarithm of the iterations during optimization.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Log-likelihood contribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="st">"loglikcontribution"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/plot_loglikcontribution-1.png" width="1152"></p>
<p>In addition, the coefficient paths during optimization can be visualized:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coefficient path</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/plot_coefpath-1.png" width="1152"></p>
<p>The left plot shows the parameters of the two components (<span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\log(\sigma_1)\)</span>, <span class="math inline">\(\mu_2\)</span>, <span class="math inline">\(\log(\sigma_2)\)</span>), the right one the standardized coefficients of the concomitant model.</p>
<p>Last but not least a histogram with the two clusters is plotted. <code>which = "hist"</code>creates an empirical density histogram separating “no foehn” and “foehn” events adding the estimated distribution for these two clusters.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="st">"hist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/plot_histogram-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="time-series-plot">Time Series Plot<a class="anchor" aria-label="anchor" href="#time-series-plot"></a>
</h2>
<p>The Californian demo data set has non-standard variable names (by purpose). Thus, when calling <code>tsplot</code> (time series plot) we do have to manually specify these names.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Some smaller quality issues in the data (should not be a big deal)</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2017-02-01"</span><span class="op">)</span></span>
<span><span class="va">end</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2017-02-12"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># As we dont have the standard names: re-specify variable names.</span></span>
<span><span class="co"># In addition, use 'style = "advanced"' to show more details.</span></span>
<span><span class="fu"><a href="../reference/tsplot.html">tsplot</a></span><span class="op">(</span><span class="va">mod</span>, style <span class="op">=</span> <span class="st">"advanced"</span>, </span>
<span>       windsector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       start <span class="op">=</span> <span class="va">start</span>, end <span class="op">=</span> <span class="va">end</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/tsplot-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="wind-rose-plot">Wind Rose Plot<a class="anchor" aria-label="anchor" href="#wind-rose-plot"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="st">".."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">foehnix</span></span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/windrose.html">windrose</a></span><span class="op">(</span><span class="va">mod</span>,</span>
<span>         type <span class="op">=</span> <span class="st">"hist"</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foehn"</span>, <span class="st">"nofoehn"</span><span class="op">)</span>,</span>
<span>         windsector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">22</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/windrose-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="hovmöler-diagram">Hovmöler Diagram<a class="anchor" aria-label="anchor" href="#hovm%C3%B6ler-diagram"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default image plot</span></span>
<span><span class="fu"><a href="../reference/image.html">image</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/image1-1.png" width="1152"></p>
<p>Customized plot which shows the “foehn frequency” for the interesting time period from August to April with custom colors and additional contour lines and custom aggregation period (two-weeks, 3-hourly).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customizing image plot</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="st">".."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">foehnix</span></span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/image.html">image</a></span><span class="op">(</span><span class="va">mod</span>, deltad <span class="op">=</span> <span class="fl">10L</span>, deltat <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="fl">3600</span>, contours <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      contour.col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, labcex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>      col <span class="op">=</span> <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/hcl_palettes.html" class="external-link">sequential_hcl</a></span><span class="op">(</span><span class="fl">51</span>, <span class="st">"Purple-Yellow"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">212</span>, <span class="fl">119</span><span class="op">)</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/image2-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="compare-models-gaussian">Compare Models (Gaussian)<a class="anchor" aria-label="anchor" href="#compare-models-gaussian"></a>
</h2>
<p>The model above (<code>diff_t ~ rh + ff</code>) fits this station well, however, we could of course change the model specifications. Let us specify a second model solely based on the target station (valley site). This can be important in practice if:</p>
<ul>
<li>A upstream crest station is not available.</li>
<li>The data availability for the crest station is limited due to outages, is no longer maintained, or has been installed much later than the valley station.</li>
</ul>
<p>Thus, we estimate a second model <code>mod_valley</code> using the following model specification:</p>
<ul>
<li>Data set: Ellbögen (<code>ell</code>; <code>demodata("ellboegen")</code>)</li>
<li>Main variable: <code>ff</code> (wind speed)</li>
<li>Concomitants: <code>rf</code> (relative humidity)</li>
<li>Wind filter: <code>dd</code> <span class="math inline">\(\in [43, 223]\)</span> (as above)</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load demo data set</span></span>
<span><span class="va">ell</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demodata.html">demodata</a></span><span class="op">(</span><span class="st">"ellboegen"</span><span class="op">)</span></span>
<span><span class="co"># Estimate alternative model</span></span>
<span><span class="va">mod_valley</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">ff</span> <span class="op">~</span> <span class="va">rh</span>, data <span class="op">=</span> <span class="va">ell</span>,</span>
<span>                      filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_valley</span>, which <span class="op">=</span> <span class="st">"hist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/mod_valley-1.png" width="768"></p>
<p>To compare the performance of the two models we can calculate a set of information criterion. The following matrix shows the sample size (<code>N</code>), log-likelihood sum (<code>loglik</code>), Akaike information criterion (<code>AIC</code>), Bayesian information criterion (<code>BIC</code>), and ignorance (<code>IGN</code>).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_IC</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">filter_obj</span><span class="op">$</span><span class="va">good</span><span class="op">)</span>, <span class="fu"><a href="../reference/foehnix.html">logLik</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="../reference/foehnix.html">AIC</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="../reference/foehnix.html">BIC</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="../reference/IGN.html">IGN</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">IC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod</span>, mod_valley <span class="op">=</span> <span class="va">mod_valley</span><span class="op">)</span>, <span class="va">get_IC</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">IC</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             mod mod_valley</span></span>
<span><span class="co">## N       24428.0    52390.0</span></span>
<span><span class="co">## loglik -55044.0  -131631.0</span></span>
<span><span class="co">## AIC    110101.9   263274.1</span></span>
<span><span class="co">## BIC    110158.6   263327.3</span></span>
<span><span class="co">## IGN         2.3        2.5</span></span></code></pre>
<p><strong>Warning:</strong> due to the model specification the two models are based on different data sets (sample size strongly differs). Thus, we <em>cannot directly compare the models</em> using <code>loglik</code>, <code>AIC</code>, or <code>BIC</code>. <code>IGN</code> accounts for the sample size (mean negative log-likelihood), however, as the two models include different training data sets this is inconclusive.</p>
<p>For a fair and reliable comparison one should estimate both models on the very same data set, e.g., as follows:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the demo data set once more</span></span>
<span><span class="va">data_for_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demodata.html">demodata</a></span><span class="op">(</span><span class="st">"tyrol"</span><span class="op">)</span></span>
<span><span class="co"># Extract the required variables</span></span>
<span><span class="va">data_for_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">data_for_comparison</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dd</span>, <span class="va">ff</span>, <span class="va">rh</span>, <span class="va">diff_t</span>, <span class="va">crest_dd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Remove all observations (rows) with missing values</span></span>
<span><span class="va">data_for_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data_for_comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate alternative model "mod_comparison"</span></span>
<span><span class="co"># Note: using dd/crest_dd filter for both models (required to</span></span>
<span><span class="co"># end up with the same sample size)</span></span>
<span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span>, crest_dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">270</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mod_comparison</span>        <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>,</span>
<span>                                 data <span class="op">=</span> <span class="va">data_for_comparison</span>,</span>
<span>                                 filter <span class="op">=</span> <span class="va">filter</span><span class="op">)</span></span>
<span><span class="va">mod_valley_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">mod_valley</span><span class="op">)</span>,</span>
<span>                                 data <span class="op">=</span> <span class="va">data_for_comparison</span>,</span>
<span>                                 filter <span class="op">=</span> <span class="va">filter</span><span class="op">)</span></span></code></pre></div>
<p>Again, calculate the information criteria:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Information criteria</span></span>
<span><span class="va">IC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_comparison <span class="op">=</span> <span class="va">mod_comparison</span>,</span>
<span>                  mod_valley_comparison <span class="op">=</span> <span class="va">mod_valley_comparison</span><span class="op">)</span>, <span class="va">get_IC</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">IC</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        mod_comparison mod_valley_comparison</span></span>
<span><span class="co">## N             24428.0               24428.0</span></span>
<span><span class="co">## loglik       -55044.0              -65793.6</span></span>
<span><span class="co">## AIC          110101.9              131599.3</span></span>
<span><span class="co">## BIC          110158.6              131647.9</span></span>
<span><span class="co">## IGN               2.3                   2.7</span></span></code></pre>
<p>Both models are now based on the same sample (<span class="math inline">\(N = 2.4428\times 10^{4}\)</span>). Thus, we can compare the different scores. The more complex model (<code>mod_comparison</code>) outperforms the one solely based on observations from the valley site. Thus, the model <code>mod</code> should be preferred over the simpler one. However, in practice it is often useful to have both (more than one) model to fill in periods where e.g., the crest station does not provide data.</p>
<p>To fill gaps (missing values in the classification of model <code>mod</code>) we could combine the estimates of both models:</p>
<ul>
<li>First, take probabilities from model <code>mod</code>. If not available,</li>
<li>take estimates from model <code>mod_valley</code>.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine results of both models:</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>, mod_valley <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">mod_valley</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of missing entries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">prob</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        mod mod_valley </span></span>
<span><span class="co">##      38859      11162</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For demonstration purposes: find rows where mod is missing</span></span>
<span><span class="co"># while mod_valley returns a probability:</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">prob</span><span class="op">$</span><span class="va">mod</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">prob</span><span class="op">$</span><span class="va">mod_valley</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">prob</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     mod  mod_valley</span></span>
<span><span class="co">## 2006-01-01 07:00:00   0 0.000000000</span></span>
<span><span class="co">## 2006-01-01 08:00:00   0 0.000000000</span></span>
<span><span class="co">## 2006-01-01 09:00:00   0 0.000000000</span></span>
<span><span class="co">## 2006-01-01 10:00:00  NA 0.001756782</span></span>
<span><span class="co">## 2006-01-01 11:00:00   0 0.001629606</span></span>
<span><span class="co">## 2006-01-01 12:00:00   0 0.000000000</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine the two (take probability from mod if available,</span></span>
<span><span class="co"># else from mod_valley; both missing: NA).</span></span>
<span><span class="va">combine_prob</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">prob</span>, <span class="fl">1</span>, <span class="va">combine_prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">prob</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2006-01-01 07:00:00 2006-01-01 08:00:00 2006-01-01 09:00:00 2006-01-01 10:00:00 </span></span>
<span><span class="co">##         0.000000000         0.000000000         0.000000000         0.001756782 </span></span>
<span><span class="co">## 2006-01-01 11:00:00 2006-01-01 12:00:00 </span></span>
<span><span class="co">##         0.000000000         0.000000000</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check missing values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 11162</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2010-02-01"</span><span class="op">)</span></span>
<span><span class="va">end</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2010-02-15"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Time series plot to compare "mod" (the most complex model)</span></span>
<span><span class="co"># and the four alternatives.</span></span>
<span><span class="fu"><a href="../reference/tsplot.html">tsplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod</span>, mod_valley <span class="op">=</span> <span class="va">mod_valley</span><span class="op">)</span>,</span>
<span>       style <span class="op">=</span> <span class="st">"advanced"</span>,</span>
<span>       windsector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       start <span class="op">=</span> <span class="va">start</span>, end <span class="op">=</span> <span class="va">end</span><span class="op">)</span></span></code></pre></div>
<p><img src="ellboegen_files/figure-html/alt_tsplot-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="compare-models-distributions">Compare Models (Distributions)<a class="anchor" aria-label="anchor" href="#compare-models-distributions"></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Formula and wind direction filter specification</span></span>
<span><span class="va">filter</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">223</span><span class="op">)</span>, crest_dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">270</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="st">"ff ~ rh"</span></span>
<span></span>
<span><span class="co"># Gaussian models: Gaussian, left-censored Gaussian (at 0),</span></span>
<span><span class="co"># and left-truncated Gaussian (at 0). Note that, for demonstration</span></span>
<span><span class="co"># purposes, the censored/truncated models do 20 iterations.</span></span>
<span><span class="va">mod_gauss</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                      verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mod_cgauss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                      left <span class="op">=</span> <span class="fl">0</span>, tol <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, maxit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                      verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, post, beta = ccmodel$beta, standardize = FALSE, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_tgauss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                      left <span class="op">=</span> <span class="fl">0</span>, tol <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, maxit <span class="op">=</span> <span class="fl">20</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Logistic models: logistic, left-censored logistic (at 0),</span></span>
<span><span class="co"># and left-truncated logistic (at 0). Again, fixed number of</span></span>
<span><span class="co"># iterations for the censored and truncated models.</span></span>
<span><span class="va">mod_logis</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                      verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mod_clogis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                      left <span class="op">=</span> <span class="fl">0</span>, tol <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, maxit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                      verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_tlogis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>                      left <span class="op">=</span> <span class="fl">0</span>, tol <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, maxit <span class="op">=</span> <span class="fl">20</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span>
<span></span>
<span><span class="co">## Warning in iwls_logit(logitX, z, standardize = FALSE, maxit = tail(maxit, :</span></span>
<span><span class="co">## IWLS solver for logistic model did not converge.</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Information criteria</span></span>
<span><span class="va">get_IC</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">filter_obj</span><span class="op">$</span><span class="va">good</span><span class="op">)</span>, <span class="fu"><a href="../reference/foehnix.html">logLik</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="../reference/foehnix.html">AIC</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="../reference/foehnix.html">BIC</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="../reference/IGN.html">IGN</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">IC</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gaussian"</span>           <span class="op">=</span> <span class="va">mod_gauss</span>,</span>
<span>                      <span class="st">"gaussian censored"</span>  <span class="op">=</span> <span class="va">mod_cgauss</span>,</span>
<span>                      <span class="st">"gaussian truncated"</span> <span class="op">=</span> <span class="va">mod_tgauss</span>,</span>
<span>                      <span class="st">"logistic"</span>           <span class="op">=</span> <span class="va">mod_logis</span>,</span>
<span>                      <span class="st">"logistic censored"</span>  <span class="op">=</span> <span class="va">mod_clogis</span>,</span>
<span>                      <span class="st">"logistic truncated"</span> <span class="op">=</span> <span class="va">mod_tlogis</span><span class="op">)</span>,</span>
<span>                 <span class="va">get_IC</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">IC</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                         N    loglik      AIC      BIC      IGN</span></span>
<span><span class="co">## gaussian           102918 -246274.4 492560.8 492618.1 2.392919</span></span>
<span><span class="co">## gaussian censored  102918 -247830.5 495672.9 495730.2 2.408038</span></span>
<span><span class="co">## gaussian truncated 102918 -246474.3 492960.6 493017.9 2.394861</span></span>
<span><span class="co">## logistic           102918 -245950.4 491912.9 491970.1 2.389771</span></span>
<span><span class="co">## logistic censored  102918 -249237.9 498487.9 498545.1 2.421714</span></span>
<span><span class="co">## logistic truncated 102918 -246232.2 492476.5 492533.7 2.392509</span></span></code></pre>
<p>As the number of observations the classification is based on is the same for all models, we can directly compare the information criteria (i.e., AIC, BIC, log-likelihood). In all cases the “logistic” model seems to perform best among these models.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
