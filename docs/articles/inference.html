<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • foehnix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="">
<meta property="og:description" content="foehnix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foehnix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ellboegen.html">[Demo] Ellbögen (Tyrol, A)</a>
    </li>
    <li>
      <a href="../articles/viejas.html">[Demo] Viejas (California, USA)</a>
    </li>
    <li>
      <a href="../articles/windrose.html">[Plot] Wind Rose</a>
    </li>
    <li>
      <a href="../articles/tsplot.html">[Plot] Time Series</a>
    </li>
    <li>
      <a href="../articles/image.html">[Plot] Hovmöller Diagram</a>
    </li>
    <li>
      <a href="../articles/import_data.html">Import Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mixedmodel.html">Statistical Model</a>
    </li>
    <li>
      <a href="../articles/logisticregression.html">Logistic Regression (IWLS)</a>
    </li>
    <li>
      <a href="../articles/inference.html">Inference</a>
    </li>
    <li>
      <a href="../articles/advanced_simulation.html">Censoring and Truncation</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Verification with Simulated Data</a>
    </li>
    <li>
      <a href="../articles/families.html">foehnix Families</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/retostauffer/Rfoehnix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="inference_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/retostauffer/Rfoehnix/blob/HEAD/vignettes/inference.Rmd" class="external-link"><code>vignettes/inference.Rmd</code></a></small>
      <div class="hidden name"><code>inference.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="foehnix-demo">Foehnix Demo<a class="anchor" aria-label="anchor" href="#foehnix-demo"></a>
</h2>
<p><code>foehnix</code> objects also provide asymptotic inference of the estimated coefficients of the mixture model (see <a href="mixedmodel.html">statistical model</a> and <a href="logisticregression.html">logistic regression with IWLS</a>).</p>
<p>Let’s start with estimating our demo <code>flexmix</code> foehn diagnosis model. We have already prepared the data sets (object <code>data</code>). Details how to generate the data object and more information about the <code>foehnix</code> model specification can be found <a href="foehnix.html">on the getting started</a> manual page.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the model</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foehnix.html">foehnix</a></span><span class="op">(</span><span class="va">diff_t</span> <span class="op">~</span> <span class="va">ff</span> <span class="op">+</span> <span class="va">rh</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>The <code>summary</code> method prints the test statistics for both parts of the mixture model, the component model and the concomitant model (if specified).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span>, detailed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call: foehnix(formula = diff_t ~ ff + rh, data = data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of observations (total)   113952 (5527 due to inflation)</span></span>
<span><span class="co">## Removed due to missing values     20014 (17.6 percent)</span></span>
<span><span class="co">## Outside defined wind sector           0 (0.0 percent)</span></span>
<span><span class="co">## Used for classification           93938 (82.4 percent)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Climatological foehn occurance 75.87 percent (on n = 93938)</span></span>
<span><span class="co">## Mean foehn probability 75.61 percent (on n = 93938)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log-likelihood: -221461.2, 7 effective degrees of freedom</span></span>
<span><span class="co">## Corresponding AIC = 442936.3, BIC = 443002.5</span></span>
<span><span class="co">## Time required for model estimation: 10.5 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cluster separation (ratios close to 1 indicate</span></span>
<span><span class="co">## well separated clusters):</span></span>
<span><span class="co">##                        prior  size post&gt;0 ratio</span></span>
<span><span class="co">## Component 1 (foehn)     0.76 71268  93682  0.76</span></span>
<span><span class="co">## Component 2 (no foehn)  0.24 22670  62085  0.37</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ---------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Concomitant model: z test of coefficients</span></span>
<span><span class="co">##                   Estimate  Std. error  z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">## cc.(Intercept)  2.34150441  0.04768558   49.103 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## cc.ff          -1.88353356  0.00519504 -362.564 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## cc.rh           1.76129854  0.00077906 2260.790 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## Number of IWLS iterations: 1 (algorithm converged)</span></span>
<span><span class="co">## Dispersion parameter for binomial family taken to be 1.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="component-model-inference">Component Model Inference<a class="anchor" aria-label="anchor" href="#component-model-inference"></a>
</h2>
<p>The inference for the two location parameters <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> of the two components are based on the asymptotic theory. We expect that the estimates of our coefficients are unbiased. Thus, the expectation of our estimated coefficients is the estimated coefficient itself (<span class="math inline">\(\text{E}(\hat{\mu}_1) = \mu_1\)</span>, <span class="math inline">\(\text{E}(\hat{\mu}_2) = \mu_2\)</span>).</p>
<p>In a general form the covariance matrix of a liner model (one component, unweighted) for a set of <span class="math inline">\(i = 1, \dots, N\)</span> observations can be expressed as follows:</p>
<ul>
<li><span class="math inline">\(\text{Cov}(\beta) = \frac{1}{N - P} \mathit{\epsilon}^\top \mathit{\epsilon} (\mathbf{X}^\top \mathbf{X})^{-1}\)</span></li>
</ul>
<p>… where <span class="math inline">\(N\)</span> is the sample size, <span class="math inline">\(P\)</span> the number of parameters or covariates, <span class="math inline">\(\mathit{\epsilon} = \mathit{y} - \mu_\bullet\)</span> the model residuals, and <span class="math inline">\(\mathbf{X}\)</span> the model matrix of the linear model. In case of a <code>foehnix</code> model we have two components where each component consists of an intercept only model (<span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> do not depend on additional covariates). Thus, <span class="math inline">\(P = 1\)</span> and <span class="math inline">\(\mathbf{X}\)</span> is an <span class="math inline">\(N \times 1\)</span> matrix with 1s. The estimates are based on a set of weighted observation <span class="math inline">\(y\)</span>, in this example <code>diff_t</code> (<span class="math inline">\(y =\)</span> <code>diff_t</code>). The weights are the a-posteriori probabilities <span class="math inline">\(\hat{\mathit{p}}\)</span> (the foehn probabilities) of the <code>foehnix</code> model and have to be taken into account when calculating the standard errors. With these weights the standard error for <em>component 2</em> can be written as:</p>
<ul>
<li><span class="math inline">\(\hat{\text{sd}}(\mu_2)^2 = \frac{1}{\sum_{i=1}^N \hat{p}_i - 1} (\mathit{\epsilon} \cdot \hat{\mathit{p}})^\top (\mathit{\epsilon} \cdot \hat{\mathit{p}}) \big((\mathbf{X} \cdot \hat{\mathit{p}})^\top (\mathbf{X} \cdot \hat{\mathit{p}})\big)^{-1}\)</span></li>
</ul>
<p>… or much simpler:</p>
<ul>
<li><span class="math inline">\(\hat{\text{sd}}(\mu_2)^2 = \frac{1}{\sum_{i=1}^N \hat{p}_i^2 \cdot (\sum_{i=1}^N \hat{p}_i - 1)} \sum_{i=1}^N \big((y_i - \mu_2) \cdot \hat{p}_i\big)^2\)</span></li>
</ul>
<p>The same holds for <em>component 1</em> except that our weights are <span class="math inline">\(1 - \hat{\mathit{p}}\)</span>:</p>
<ul>
<li><span class="math inline">\(\hat{\text{sd}}(\mu_1)^2 = \frac{1}{\sum_{i=1}^N (1 - \hat{p}_i)^2 \cdot (\sum_{i=1}^N (1 - \hat{p}_i) - 1)} \sum_{i=1}^N \big((y_i - \mu_2) \cdot (1 - \hat{p}_i)\big)^2\)</span></li>
</ul>
</div>
<div class="section level2">
<h2 id="concomitant-model-inference">Concomitant Model Inference<a class="anchor" aria-label="anchor" href="#concomitant-model-inference"></a>
</h2>
<p>If a concomitant model has been specified <code>summary</code> will also return the corresponding z statistics for the estimated regression coefficients of the logistic regression model (see <a href="logisticregression.html">logistic regression with IWLS</a>).</p>
<p>The covariance matrix of a logistic logistic regression model with the regression coefficients <span class="math inline">\(\mathit{\alpha}\)</span> (with <span class="math inline">\(P\)</span> coefficients) with a dispersion parameter of 1 of the binomial family is given as:</p>
<ul>
<li><span class="math inline">\(\hat{\text{cov}}(\mathit{\alpha}) = (\mathbf{X} \mathit{\omega})^\top (\mathbf{X} \mathit{\omega})\)</span></li>
</ul>
<p>where <span class="math inline">\(\mathbf{X}\)</span> is the model matrix of the concomitant model (un-standardized) of dimension <span class="math inline">\(N \times P\)</span> and <span class="math inline">\(\mathit{\omega} = (\mathit{\pi} * (1 - \mathit{\pi}))^\frac{1}{2}\)</span>. <span class="math inline">\(\pi\)</span> is final response, probability returned by the logistic regression model. The diagonal of the covariance matrix contains the variances of the estimated regression coefficients. Thus,</p>
<ul>
<li>
<span class="math inline">\(\hat{\text{sd}}(\mathit{\alpha}) = \Big( \text{diag}\big((\mathbf{X} \mathit{\omega})^\top (\mathbf{X} \mathit{\omega}) \big) \Big)^\frac{1}{2}\)</span>.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
