<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Foehn Classification Based on a Two-Component Mixture Model — foehnix • foehnix</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Foehn Classification Based on a Two-Component Mixture Model — foehnix"><meta property="og:description" content="This is the main method of the foehnix package to estimate
two-component mixture models for automated foehn classification."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foehnix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ellboegen.html">[Demo] Ellbögen (Tyrol, A)</a>
    </li>
    <li>
      <a href="../articles/viejas.html">[Demo] Viejas (California, USA)</a>
    </li>
    <li>
      <a href="../articles/windrose.html">[Plot] Wind Rose</a>
    </li>
    <li>
      <a href="../articles/tsplot.html">[Plot] Time Series</a>
    </li>
    <li>
      <a href="../articles/image.html">[Plot] Hovmöller Diagram</a>
    </li>
    <li>
      <a href="../articles/import_data.html">Import Data</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mixedmodel.html">Statistical Model</a>
    </li>
    <li>
      <a href="../articles/logisticregression.html">Logistic Regression (IWLS)</a>
    </li>
    <li>
      <a href="../articles/inference.html">Inference</a>
    </li>
    <li>
      <a href="../articles/advanced_simulation.html">Censoring and Truncation</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Verification with Simulated Data</a>
    </li>
    <li>
      <a href="../articles/families.html">foehnix Families</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/retostauffer/Rfoehnix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Foehn Classification Based on a Two-Component Mixture Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/retostauffer/Rfoehnix/blob/HEAD/R/foehnix.R" class="external-link"><code>R/foehnix.R</code></a>, <a href="https://github.com/retostauffer/Rfoehnix/blob/HEAD/R/foehnix_functions.R" class="external-link"><code>R/foehnix_functions.R</code></a></small>
    <div class="hidden name"><code>foehnix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main method of the foehnix package to estimate
two-component mixture models for automated foehn classification.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">foehnix</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  switch <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="foehnix.control.html">foehnix.control</a></span><span class="op">(</span><span class="va">family</span>, <span class="va">switch</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu">logLik</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu">nobs</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu">AIC</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu">BIC</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu"><a href="IGN.html">IGN</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu"><a href="edf.html">edf</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for foehnix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, eps <span class="op">=</span> <span class="fl">1e-04</span>, detailed <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>an object of class <code>formula</code> (or one that can be coerced
to that class): a symbolic description of the model to be fitted.  The
details of model specification are given under 'Details'.</p></dd>


<dt>data</dt>
<dd><p>a regular (not necessarily strictly regular)
time series object of class <code>zoo</code> containing the
variables for the two-part mixture model.</p></dd>


<dt>switch</dt>
<dd><p>logical. If set to <code>TRUE</code> the two estimated components
will be switched. This is important if the covariate for the components
(left hand side of input <code>formula</code> is smaller for cases with foehn than
for cases without foehn, e.g., when using the temperature difference as main
covariate.</p></dd>


<dt>filter</dt>
<dd><p>a named list can be provided to apply a custom (simple) filter
to the observations on <code>data</code>. Can be used to e.g., prespecify a
specific wind sector for foehn winds. Please read the manual of the
<code><a href="foehnix_filter.html">foehnix_filter</a></code> method for more details and examples.</p></dd>


<dt>family</dt>
<dd><p>character (at the moment <code>"gaussian"</code> or <code>"logistic"</code>)
or an object of class <code>foehnix.family</code>.</p></dd>


<dt>control</dt>
<dd><p>additional control arguments, see <code><a href="foehnix.control.html">foehnix.control</a></code>.</p></dd>


<dt>...</dt>
<dd><p>forwarded to <code><a href="foehnix.control.html">foehnix.control</a></code></p></dd>


<dt>object</dt>
<dd><p>a <code>foehnix</code> object (input for S3 methods)</p></dd>


<dt>x</dt>
<dd><p>a <code>foehnix</code> object (input for S3 methods)</p></dd>


<dt>eps</dt>
<dd><p>threshold for posterior probabilities used in <code>summary</code>.
<code>numeric</code> value, default <code>1e-4</code>.</p></dd>


<dt>detailed</dt>
<dd><p>boolean, default <code>FALSE</code>. If <code>TRUE</code>, additional information
will be returned.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns an object of class <code>foehnix</code>.</p>


<p>Log-likelihood sum (<code>numeric</code>).</p>


<p>Number of observations (<code>integer</code>) used to train the model.</p>


<p>Returns the Akaike information criterion (<code>numeric</code>).</p>


<p>Bayesian information criterion (<code>numeric</code>).</p>


<p>Ignorance (mean negative log-likelihood; <code>numeric</code>).</p>


<p>Effective degrees of freedom.</p>


<p>Returns the formula of the model (<code>formula</code>).</p>


<p>Object of class <code>summary.foehnix</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The two-component mixture model can be specified via formula object where
the left hand side of the formula contains the 'main' variable explaining the two
components (only one variable), the right hand side of the formula specifies
the concomitant variables (multiple variables allowed).  As an example:
let's assume that our zoo object <code>data</code> contains the following
columns:</p><ul><li><p><code>ff</code>: observed wind speed at target site</p></li>
<li><p><code>rh</code>: observed relative humidity at target site</p></li>
<li><p><code>diff_t</code>: (potential) temperature difference between target site and a station
          upstream of the foehn wind direction</p></li>
</ul><p>The specification for <code>formula</code> could e.g. look as follows:</p><ul><li><p><code>ff ~ 1</code>: the two components of the mixture model will be
          based on the observed wind speed (<code>ff</code>), no concomitant
          model (right hand side is simply <code>1</code>).</p></li>
<li><p><code>ff ~ rh</code>: similar to the specification above, but using
           observed relative humidity (<code>rh</code>) as concomitant.</p></li>
<li><p><code>ff ~ rh + diff_t</code>: as above but with an additional second
          concomitant variable (observed temperature difference, <code>diff_t</code>).</p></li>
<li><p><code>diff_t ~ ff + rh</code>: using temperature difference as the main
          variable for the two components while <code>ff</code> and <code>rh</code> are
          used as concomitants. Note: in this case it will be required to set
          <code>switch = TRUE</code> as lower values of <code>diff_t</code> indicate
          less stratified conditions where the occurrence of foehn is
          more likely. If <code>switch = FALSE</code> the two components (foehn
          and no foehn) may be interchanged and the model will return
          "probabilities of not observing foehn".</p></li>
</ul><p>Note that these are just examples and have to be adjusted given data
availability, location, structure/names of the variables in the <code>data</code>
object.</p>
<p>The optional input <code>filter</code> allows to specify simple or complex
filters (see <code><a href="foehnix_filter.html">foehnix_filter</a></code> for details).
This allows to add additional constraints, e.g., adding a filter on the
observed wind direction to ensure that only events within a specific wind
sector (the main foehn wind direction) are classified as "foehn".</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Plavcan D, Mayr GJ, Zeileis A (2014).
Automatic and Probabilistic Foehn Diagnosis with a Statistical Mixture Model.
<em>Journal of Applied Meteorology and Climatology</em>.
<b>53</b>(3), 652--659. <a href="https://doi.org/10.1175/JAMC-D-13-0267.1" class="external-link">doi:10.1175/JAMC-D-13-0267.1</a></p>
<p>Gr\"un B, Leisch F (2007).
Fitting Finite Mixtures of Generalized Linear Regressions in <em>R</em>.
<em>Computational Statistics \&amp; Data Analysis</em>. <b>51</b>(11), 5247--5252.
<a href="https://doi.org/10.1016/j.csda.2006.08.014" class="external-link">doi:10.1016/j.csda.2006.08.014</a></p>
<p>Gr\"un B, Leisch F (2008).
FlexMix Version 2: Finite Mixtures with Concomitant Variables and Varying and Constant Parameters.
<em>Journal of Statistical Software, Articles</em>.
<b>28</b>(4), 1--35. <a href="https://doi.org/10.18637/jss.v028.i04" class="external-link">doi:10.18637/jss.v028.i04</a></p>
<p>Fraley C, Raftery AE (2002).
Model-Based Clustering, Discriminant Analysis, and Density Estimation.
<em>Journal of the American Statistical Association</em>.
<b>97</b>(458), 611--631. <a href="https://doi.org/10.1198/016214502760047131" class="external-link">doi:10.1198/016214502760047131</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <code><a href="foehnix_filter.html">foehnix_filter</a></code> for more information about the
<code>filter</code> option.  See also: <code><a href="tsplot.html">tsplot</a></code>, <code><a href="windrose.html">windrose</a></code>.</p>
<p>Foehnix family objects: <code><a href="foehnix.family.html">foehnix.family</a></code>.</p>
<p>S3 methods for <code>foehnix</code> objects:
<code><a href="plot.foehnix.html">plot.foehnix</a></code>,
<code><a href="predict.foehnix.html">predict.foehnix</a></code>,
<code><a href="fitted.foehnix.html">fitted.foehnix</a></code>,
<code>print.foehnix</code>,
<code>summary.foehnix</code>,
<code><a href="windrose.html">windrose.foehnix</a></code>,
<code><a href="coef.foehnix.html">coef.foehnix</a></code>,
<code>nobs.foehnix</code>,
<code>edf.foehnix</code>,
<code>AIC.foehnix</code>,
<code>BIC.foehnix</code>,
<code>IGN.foehnix</code>,
<code>logLik.foehnix</code>,
...</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Reto Stauffer</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

